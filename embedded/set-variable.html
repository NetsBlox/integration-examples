<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<title>Embedded NetsBlox</title>
		<script charset="utf-8" src="https://editor.netsblox.org/embedded-api.js"></script>
	</head>
	<body style="margin:0;">
		<iframe id="netsblox" frameborder="0" style="width:50%;height:100%;position:absolute;"></iframe>
		<iframe id="netsblox2" frameborder="0" style="left:50%;width:50%;height:100%;position:absolute;"></iframe>
	</body>
	<script charset="utf-8">
		window.onload = () => {
			/*
			 * This example: 
			 *    - generates a random name to use to connect to one another
			 *    - opens two projects with "addressVariable" set to this value
			 *    - uses a cloud variable with the given name to connect to one another
			 */
			const uniqueID = Math.floor(Math.random() * 10000);  // This isn't unique but in practice it should be for this type of project
			const projectURL = 'https://raw.githubusercontent.com/NetsBlox/integration-examples/main/embedded/set-variable.xml';
			const addressVariable = 'example_' + uniqueID;
			const params = {
				setVariable: `addressVariable=${addressVariable}`,
			};
			const paramString = Object.entries(params)
				.map(([key, value]) => `${key}=${encodeURIComponent(value)}`)
				.join('&');

			const url = `https://editor.netsblox.org#open:${projectURL}?${paramString}`;

			const container = document.getElementById('netsblox');
			container.setAttribute('src', url);
			const container2 = document.getElementById('netsblox2');
			container2.setAttribute('src', url);

			console.log('Now, you can interact with netsblox using:', netsblox);
			console.log('Please open the project found in this directory to see an example project.');
		};
	</script>
</html>
